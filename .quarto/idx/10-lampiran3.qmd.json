{"title":"Eksplorasi dan visualisasi data","markdown":{"headingText":"Eksplorasi dan visualisasi data","headingAttr":{"id":"lampiran3","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"\nPada bagian ini, akan dijelaskan secara umum tentang eksplorasi dan visualisasi data kehati menggunakan Rstudio. RStudio adalah perangkat lunak yang sangat populer digunakan oleh para peneliti dan analis data untuk memproses, menganalisis, dan visualisasi data. Keuntungan menggunakan RStudio adalah dapat mengakses dan menggunakan berbagai paket dan fungsi statistik yang tersedia secara gratis. Selain itu, RStudio juga memungkinkan pengguna untuk mengintegrasikan skrip dan luaran dalam satu tempat, sehingga analisa yang dijalankan dapat dengan mudah direplikasi pada kajian yang lain.\n\nNamun, terdapat beberapa kekurangan dalam menggunakan RStudio, seperti tampilan antarmuka pengguna yang kurang intuitif dan sulit dipelajari bagi pemula. Selain itu, pengguna harus memahami bahasa pemrograman R untuk dapat menggunakan RStudio secara efektif. Perlu diingat bahwa ini hanya merupakan pengantar dan untuk memahami seluruh aspek dari Rstudio, diperlukan pembelajaran yang lebih mendalam.\n\n::: {.callout-caution collapse=\"true\"}\n## Klik bagian ini bagi pengguna R pertama kali\n\nPenjelasan dan langkah instalasi R studio dapat dilihat pada tautan berikut ini '[Panduan instalasi Rstudio](https://ffionline-my.sharepoint.com/:b:/g/personal/ravriandy_fauna-flora_org/ETx2GFuyFMFNgFmxvMVXYvkBE7K12f_BpVfWlAj-fD-x2g?e=UU46yW)'. Ikuti langkah yang ada pada panduan tersebut hingga bagian instalasi Rtools!\n\nSetelah itu salin dan tempel seluruh skrip dibawah ini di konsol Rstudio kalian;\n\npackages \\<- c(\"tidyverse\", \"BiodiversityR\", \"SpadeR\", \"iNEXT\", \"ggrepel\", \"ggplot2\", \"kableExtra\")\n\nfor (package in packages) { if (!requireNamespace(package, quietly = TRUE)) { install.packages(package) }\n\nlibrary(package, character.only = TRUE) }\n\ninstall.packages(\"remotes\")\n\nremotes::install_github(\"gavinsimpson/ggvegan\")\n:::\n\n::: callout-important\nSeluruh data yang dipergunakan dalam panduan ini merupakan data simulasi. Seluruh analisa yang dihasilkan dalam panduan ini hanya berupaya untuk menjelaskan interpretasi dan eksplorasi data keanekaragaman hayati tanpa menggambarkan kondisi aktual pada kawasan tersebut.\n:::\n\n## Analisis kekayaan dan keseragaman spesies\n\nPada bagian ini akan melihat bagaimana komposisi spesies dari setiap unit cuplik berbeda satu sama lain, langkah pertama yang harus dilakukan adalah memuat data dan paket yang dibutuhkan\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(\n\techo = T,\n\terror = FALSE,\n\tmessage = FALSE,\n\twarning = FALSE\n)\n```\n\n```{r Preparation, echo=TRUE}\n##Memuat paket yang dibutuhkan----\nlibrary(tidyverse)\nlibrary(BiodiversityR)\nlibrary(SpadeR)\nlibrary(iNEXT)\nlibrary(ggrepel)\nlibrary(ggplot2)\nlibrary(ggvegan)\nlibrary(kableExtra)\n\n##Memuat dataset----\n# Mengunduh data dan memuat data\ndownload.file(\"https://github.com/ryanavri/Biodive-survey/raw/main/data_clean.RData\", \"data_clean.RData\")\nload(\"data_clean.RData\")\n\n#Melihat struktur data\nstr(raw_m)\n```\n\nData yang dimuat pada skrip diatas terdiri dari;\n\n-   raw, berupa data survei avifauna menggunakan titik hitung\n\n-   raw_env, merupakan data rona lingkungan dari setiap titik hitung burung diatas\n\n-   raw_m, berupa data survei mamalia menggunakan transek\n\n-   raw_t berupa data vegetasi menggunakan petak persegi.\n\nSeluruh data tersebut mengikuti protokol yang dijelaskan pada [Bab Protokol](#sec-protokol), namun hanya menggunakan beberapa kolom saja untuk penyederhanaan simulasi.\n\n### Indeks diversitas dan dominasi\n\nSelanjutnya dari data mamalia tersebut ('raw_m') tersebut kita dapat merangkum nilai indeks diversitas dan dominansi menggunakan skrip dibawah ini\n\n```{r produceindex}\nindeks_tabel <- raw_m %>%\n  count(Scientific.Name, Transect) %>%\n  group_by(Transect) %>%\n  summarize(richness = n_distinct(Scientific.Name),\n            abundance = sum(n),\n            shannon = -sum(prop.table(n) * log(prop.table(n))),\n            margalef = (n_distinct(Scientific.Name) - 1) / log(sum(n)),\n            evenness = (-sum(prop.table(n) * log(prop.table(n))))/log(length(n)),\n            simpson = sum(prop.table(n)^2))%>%\n  mutate(across(4:last_col(), ~round(., 2)))\n```\n\n```{r show_produceindex, echo=FALSE}\n#| label: tbl-rikj\n#| tbl-cap: \"Ringkasan indeks kekayaan jenis\"\n#| tbl-cap-location: top\n\nindeks_tabel %>%\n  kbl() %>%\n  kable_classic(full_width = F, html_font = \"Cambria\")\n```\n\nSelanjutnya kita dapat membuat plot untuk melihat bagaimana perbandingan kekayaan jenis antar transek pada skrip dibawah ini\n\n```{r rnaplot, echo=TRUE, fig.height=6, fig.width=8, fig.align='center', message=FALSE, warning=FALSE}\n#| label: fig-rnaplot\n#| fig-cap: \"Grafik kekayaan jenis dan kelimpahan\"\n\n(richness_plot <- indeks_tabel %>% \n   select(c(Transect, richness, abundance)) %>% \n   pivot_longer(-Transect, names_to = \"category\", values_to = \"values\") %>%\n   ggplot(aes(fill=category, y=values, x=Transect)) + \n   geom_col(position=\"dodge\", width = 0.8) + \n   geom_text(aes(label = round(values,1)), \n             position = position_dodge(0.8), vjust = -0.5, hjust = 0.5)) + \n  theme_bw()\n```\n\nPada @fig-rnaplot yang ditampilkan, jumlah spesies yang teridentifikasi dalam satu transek berkisar antara 3 hingga 6 spesies, dengan kelimpahan individu antara 18 hingga 73. Pada tabel tersebut secara sekilas mungkin kita akan menarik kesimpulan bahwa transek 1 dan 2 memiliki keanekaragaman yang lebih tinggi dibanding transek lainnya. Indeks kekayaan jenis, terutama indeks Shannon, mempertimbangkan proporsi kemerataan individu di setiap jenis. Selanjutnya, gunakan skrip dibawah ini untuk membuat grafik perbandingan indeks keanekaragaman jenis.\n\n```{r richnessplot, echo=TRUE, fig.height=6, fig.width=8, fig.align='center', message=FALSE, warning=FALSE}\n#| label: fig-richnessplot\n#| fig-cap: \"Grafik indeks kekayaan jenis\"\n\n(RI_plot <- indeks_tabel %>% \n   select(c(Transect,shannon,margalef)) %>% \n   pivot_longer(-Transect, names_to = \"index\", values_to = \"values\") %>%\n   ggplot(aes(fill=index, y=values, x=Transect)) + \n   geom_col(position=\"dodge\", width = 0.8) + \n   geom_text(aes(label = round(values,2)), \n             position = position_dodge(0.8), vjust = -0.5, hjust = 0.5)) + \n  theme_bw()\n```\n\npada @fig-richnessplot diatas, nilai indeks shannon ternyata lebih tinggi di transek 4. Hal ini disebabkan karena ketimpangan antar individu di setiap spesies jauh lebih kecil dibandingkan dengan transek 1 dan 2, meskipun jumlah spesies di kedua transek tersebut lebih banyak.\n\nSelanjutnya, kita dapat menginvestigasi lebih lanjut untuk menentukan apakah benar ada spesies yang mendominasi pada kawasan tersebut. Kondisi ini ditandai dengan nilai evenness yang rendah dan nilai dominansi simpson yang tinggi. Gunakan skrip dibawah ini untuk membuat plot indeks kemerataan dan dominansi jenis.\n\n```{r evenessplot, echo=TRUE, fig.height=6, fig.width=8, fig.align='center', message=FALSE, warning=FALSE}\n#| label: fig-evenessplot\n#| fig-cap: \"Grafik indeks kesamaan jenis\"\n\n(DI_plot <- indeks_tabel %>% \n   select(c(Transect,simpson,evenness)) %>% \n   pivot_longer(-Transect, names_to = \"index\", values_to = \"values\") %>%\n   ggplot(aes(fill=index, y=values, x=Transect)) + \n   geom_col(position=\"dodge\", width = 0.8) + \n   geom_text(aes(label = round(values,2)), \n             position = position_dodge(0.8), vjust = -0.5, hjust = 0.5)) + \n  theme_bw()\n```\n\nPada @fig-evenessplot diatas, terlihat bahwa transek 1 dan 2 menunjukan kemerataan (evenness) yang rendah dan nilai dominansi (simpson) yang lebih tinggi dibandingkan dengan transek lainnya, sehingga kita dapat menarik kesimpulan bahwa meskipun dari jumlah spesies transek 1 dan 2 ditemukan spesies lebih banyak namun keduanya memiliki ketimpangan proporsi jumlah individu yang cukup tinggi juga.\n\nGunakan skrip dibawah ini dapat digunakan untuk memeriksa lebih dalam, spesies apa yang sebetulnya mendominasi dikedua transek tersebut.\n\n```{r abundplot}\n#Membuat tabel kelimpahan spesies\nabundance_table <- raw_m %>%\n  group_by(Transect, Scientific.Name) %>%\n  summarise(abundance = n())\n```\n\nSetelah itu kita dapat membuat grafiknya dengan skrip berikut ini\n\n```{r abundplot, echo=TRUE, fig.height=6, fig.width=8, fig.align='center', message=FALSE, warning=FALSE}\n#| label: fig-abundplot\n#| fig-cap: \"Grafik kelimpahan jenis di setiap transek\"\n\n#Membuat plot kelimpahan jenis\nggplot(abundance_table, aes(x = factor(Scientific.Name, levels = rev(sort(unique(Scientific.Name)))), y = abundance, fill = Transect)) +\n    geom_bar(stat = \"identity\", position = position_dodge(width = 0.8)) +\n    labs(x = \"Species\", y = \"Abundance\", fill = \"Transect\") +\n    facet_wrap(~ Transect, ncol = 2) +\n    scale_fill_viridis_d() +\n    theme_bw() +\n    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n          axis.text.y = element_text(face = \"italic\"),\n          legend.position = \"bottom\",\n          legend.box = \"horizontal\",\n          legend.margin = margin(t = 0, r = 0, b = 0, l = 0),\n          panel.border = element_rect(colour = \"black\", fill = NA, size = 0.5)) +\n    coord_flip()\n```\n\nPada @fig-abundplot diatas memperlihatkan bahwa babi hutan (*Sus scrofa*) dan monyet ekor panjang (*Macaca fascicularis*) hampir selalu mendominasi pada setiap transek dimana pada transek 1 dan 2 terlihat dengan jelas bagaimana kedua spesies ini memiliki kelimpahan yang lebih banyak dibandingkan dengan spesies lainnya. Sebaliknya, pada transek 3, kelimpahan tiap jenisnya tidak jauh berbeda sehingga didapatkan indeks kemerataan tinggi dan indeks dominansi rendah\n\n### Indeks nilai penting pada vegetasi\n\nPada kajian vegetasi, terkadang nilai INP (Indeks Nilai Penting) dibutuhkan untuk melihat spesies yang mendominasi suatu ekosistem atau komunitas vegetasi. skrip dibawah ini dapat digunakan untuk membuat ringakasan INP dari data vegetasi ('raw_t'). Hasilnya dapat dilihat pada @tbl-ivtable yang menunjukan 6 spesies dengan nilai INP tertinggi dari akumulasi nilai frekuensi, kepadatan dan dominasi relatif.\n\n```{r iv_value}\n#Menghitung indeks nilai penting\nival <- raw_t %>% \n  group_by(Transect, Scientific.Name) %>% \n  summarise(count = n(),\n            basal = sum(0.7854*(dbh/100)^2)) %>% #konversi dbh (cm) ke basal area dalam meter persegi\n  ungroup() %>% \n  as.data.frame() %>%\n  importancevalue(site=\"Transect\", species=\"Scientific.Name\", \n                  count=\"count\", basal=\"basal\", \n                  factor=\"\",level=\"\") %>%\n  as.data.frame() %>%\n  mutate(across(3:last_col(), ~round(., 2)))\n```\n\n```{r iv_table, echo=FALSE}\n#| label: tbl-ivtable\n#| tbl-cap: \"Indeks nilai penting vegetasi\"\n#| tbl-cap-location: top\n\nival %>%\n    head() %>%\n    kbl(caption =\"Indeks nilai penting vegetasi\") %>%\n    column_spec(1, italic=T, width_min = '3in') %>% \n    kable_styling() %>%\n    scroll_box(width = \"100%\", box_css = \"border: 0px;\")\n```\n\n### Estimasi kekayaan jenis\n\nPada bagian ini, disajikan skrip untuk menghasilkan kurva akumulasi spesies (*species accumulation curve*) dari data avifauna ('raw'). Metode ini umumnya digunakan untuk menilai apakah jumlah sampel yang diperoleh dalam survei sudah cukup untuk menggambarkan keanekaragaman spesies di suatu area.\n\n```{r sac_calc}\n#Menghitung kurva akumulasi spesies----\nout1 <- raw %>% count(Scientific.Name) %>% \n  column_to_rownames(var = \"Scientific.Name\") %>% \n  as.data.frame() %>%\n  iNEXT(q=0, datatype = \"abundance\", conf = 0.95, nboot = 100) #nboot dapat ditingkatkan.\n```\n\n```{r sacplot, echo=TRUE, fig.height=6, fig.width=8, fig.align='center', message=FALSE, warning=FALSE}\n#| label: fig-sacplot\n#| fig-cap: \"Kurva akumulasi spesies berdasarkan jumlah sampel\"\n\n#Membuat grafik dari hasil tersebut\nggiNEXT(x = out1, type = 1, color.var = \"Order.q\") +\n    labs(x = \"Number of Individuals\", y = \"Cumulative Species Richness\") +\n    theme_bw() + \n    theme(axis.text = element_text(size = 12),\n          axis.title = element_text(size = 14),\n          legend.position = \"bottom\",\n          legend.title = element_text(size = 14),\n          legend.text = element_text(size = 12))\n\n```\n\nPada @fig-sacplot tersebut, kurva masih meningkat secara bertahap dan belum mencapai titik jenuh (datar), ini mengindikasikan bahwa apabila ada penambahan jumlah sampel ada kemungkinan terdapat penambahan spesies-spesies baru dalam kajian tersebut.\n\nMengingat kurva menunjukkan potensi penambahan spesies baru seiring bertambahnya sampel, skrip dibawah ini dapat digunakan untuk memperkirakan potensi penemuan spesies baru menggunakan berbagai model estimator yang hasilnya disajikan pada @tbl-esttable. Pada berbagai model tersebut dihasilkan bahwa rerata pertambahan spesies dapat mencapai hingga 90-an spesies dari total 63 spesies yang dijumpai saat survei berlangsung.\n\n```{r sactable, results='hide'}\n#Estimasi kekayaan jenis----\nout2 <- raw %>% count(Scientific.Name) %>% \n  column_to_rownames(var = \"Scientific.Name\") %>% \n  as.data.frame() %>%\n  SpadeR::ChaoSpecies(datatype = \"abundance\", k=3, conf = 0.95) #k adalah jumlah kelimpahan yang dianggap spesies \"langka\"\n\n#Menampilkan tabel estimasi spesies\nout2$Species_table\n```\n\n```{r esttable, echo=FALSE}\n#| label: tbl-esttable\n#| tbl-cap: \"Estimasi kekayaan jenis dari berbagai metode ekstrapolasi\"\n#| tbl-cap-location: top\n\nout2$Species_table %>%\n  kbl(digits=2) %>%\n  kable_classic(full_width = F, html_font = \"Cambria\")\n```\n\n## Analisis perbedaan komposisi spesies\n\nPada bagian ini akan dibahas menganai analisis perbedaan komposisi spesies antara berbagai habitat atau lokasi survei. Analisis ini penting untuk memahami bagaimana keanekaragaman spesies dipengaruhi oleh faktor lingkungan. Dengan memahami perbedaan komposisi spesies di berbagai area, kita dapat mengidentifikasi pola sebaran spesies, hubungan antara spesies dan faktor lingkungan, serta mengevaluasi dampak perubahan lingkungan terhadap keanekaragaman hayati.\n\nPada bagian ini akan diperkenalkan beberapa metode statistik yang umum digunakan untuk analisis perbedaan komposisi spesies, termasuk perhitungan indeks ketidaksamaan, analisis klaster, dan metode multivariat lainnya serta cara menafsirkan dan menyajikan hasil analisis.\n\n### Mengukur perbedaan komunitas menggunakan klaster\n\nDalam bagian ini, kita akan membahas metode populer untuk mengukur perbedaan komunitas, yaitu analisis klaster berdasarkan ketidaksamaan Bray-Curtis dan Jaccard. Metode ini membantu mengidentifikasi pola sebaran dan hubungan antara komunitas berdasarkan perbedaan komposisi spesies. Analisis klaster ini penting dalam memahami hubungan antar komunitas spesies dan pengaruh faktor lingkungan.\n\nBray-Curtis menekankan perbedaan kelimpahan spesies antara komunitas, sementara indeks Jaccard fokus pada keberadaan atau ketiadaan spesies. Bray-Curtis cocok digunakan saat kita dapat mengidentifikasi kelimpahan spesies dengan tepat, seperti pengamatan burung menggunakan titik hitung. Skrip berikut ini dapat digunakan untuk menghitung dan menyajikan perbedaan tersebut.\n\n```{r clustplot, results='hide', fig.show='hide'}\n# Membuat matriks temuan dari data burung\ndata_matrix <-table(raw$Transect, raw$Scientific.Name)\n\n# Menghitung dan membuat dendogram ketidaksamaan komunitas\ndata_matrix %>%\n  vegdist(method = \"bray\") %>%\n  hclust(method = \"average\") -> hc_transect\n\n# Membuat dendogram dari hasil tersebut\nplot(hc_transect, xlab = \"\", ylab = \"Dissimilarity\", sub = \"Transect\", hang = -1)\nrect.hclust(hc_transect, k = 4, border = 2:5) #k adalah jumlah grup, sesuaikan dengan data \n```\n\n```{r showclustplot, echo=FALSE, fig.align='center', fig.height=6, fig.width=8, message=FALSE, warning=FALSE}\n#| label: fig-showclustplot\n#| fig-cap: \"Klaster ketidaksamaan komunitas antar transek\"\n\nplot(hc_transect, xlab = \"\", ylab = \"Dissimilarity\", sub = \"Transect\", hang = -1)\nrect.hclust(hc_transect, k = 4, border = 2:5)\n```\n\n@fig-showclustplot menunjukkan dendrogram klaster yang dihasilkan dari ketidaksamaan Bray-Curtis. Cabang-cabang dendrogram menggambarkan kelompok-kelompok komunitas yang mirip, dan tinggi cabang menunjukkan tingkat perbedaan antara kelompok-kelompok tersebut. Nilai pada sumbu Y mengindikasikan indeks ketidaksamaan; semakin kecil nilainya, semakin mirip komposisi spesies dan kelimpahan relatif antara kedua komunitas. Sebaliknya, nilai yang lebih tinggi menunjukkan perbedaan yang lebih besar dalam komposisi dan kelimpahan. Gambar tersebut menunjukkan bahwa TS01 dan TS02 memiliki komposisi spesies yang paling mirip, dan kedua transek ini berbeda jauh dari TS07 hingga TS10 dalam hal komposisi spesies.\n\nSelanjutnya, skrip dibawah ini digunakan untuk menghitung ketidaksamaan Jaccard. Analisa ini digunakan ketika kelimpahan individunya tidak bisa diidentifikasi dengan pasti. Salah satu contohnya adalah ketika survei yang digunakan menggunakan perekam suara, dimana pengamat dapat mengidentifikasi perbedaan spesies, namun tidak bisa dengan pasti mengukur perbedaan individu dari suara-suara tersebut.\n\nSkrip ini akan mengkonversi data perjumpaan yang kita miliki sebagai 0 dan 1, dimana angka 0 menunjukan spesies tidak ditemukan dalam transek dan 1 adalah spesies terdeteksi, berapapun jumlahnya.\n\n```{r jc_diss, echo=TRUE, eval=FALSE}\n#Jaccard dan binary data (presence/absence)\ndata_matrix %>%\n  vegdist(method = \"jaccard\", binary = TRUE) %>%\n  hclust(method = \"average\") %>%\n  plot(xlab=\"\", ylab=\"Dissimilarity\", sub=\"Transect\", hang=-1)\n```\n\n### Mengukur perbedaan komunitas menggunakan ordinasi\n\nPada bagian ini akan dibahas metode lain yang digunakan untuk mengukur perbedaan komunitas, yaitu analisis ordinasi. Ordinasi merupakan suatu teknik multivariat yang mengatur objek-objek (misalnya, komunitas atau spesies) dalam suatu ruang berdimensi rendah berdasarkan perbedaan atau kemiripan karakteristik mereka. Tujuan dari analisis ordinasi adalah untuk menyederhanakan data yang kompleks dan mengungkapkan pola yang mendasari struktur komunitas spesies. Pada contoh kode dibawah ini, akan menggunakan analisis koordinat non-metrik (NMDS) dengan ketidaksamaan Bray-Curtis.\n\n```{r nmds, echo=T, message=FALSE, warning=FALSE}\n# Membuat matriks kelimpahan spesies\nsp.abd <- raw %>%\n  count(Transect, Scientific.Name) %>%\n  pivot_wider(names_from = Scientific.Name, values_from = n, values_fill = list(n = 0)) %>%\n  column_to_rownames(var = \"Transect\")\n\n# menghitung nilai NMDS\n(mynmds <- metaMDS(sp.abd, distance = \"bray\"))\n```\n\nPada hasil tersebut dapat dillihat bahwa nilai stres rendah (\\<0,2), menunjukkan bahwa hasil NMDS dapat diinterpretasikan dengan keyakinan yang lebih tinggi. Sedangkan nilai stres yang lebih tinggi menunjukkan bahwa interpretasi mungkin tidak dapat diandalkan. Selanjutnya, skrip dibawah ini digunakan untuk membuat plot NMDS dengan memberikan pilihan bahwa intuisi awal kita terdapat 4 kelompok utama.\n\n```{r nmdsplot, results='hide', fig.show='hide'}\n# Membagi poin-point kedalam jumlah grup yang kita tentukan\nmyclusters <- kmeans(mynmds$points, centers=4, nstart=10) #ganti centers, untuk merubah jumlah grup\ngroup <- factor(myclusters$cluster)\n\n# Membuat plot\nplot(mynmds, type=\"n\", main=\"NMDS Plot\")\npoints(mynmds, display=\"sites\", col=group, pch=16)\ntext(mynmds$points, labels=rownames(sp.abd), cex=0.7, pos = 1)\nlegend(\"bottomright\", legend=unique(group), col=unique(group), pch=16, title = \"Group\")\n```\n\n```{r shownmdstplot, echo=FALSE, fig.align='center', fig.height=6, fig.width=8, message=FALSE, warning=FALSE}\n#| label: fig-shownmdsplot\n#| fig-cap: \"Grafik ordinasi kesamaan komposisi spesies antar transek\"\n\nplot(mynmds, type=\"n\", main=\"NMDS Plot\")\npoints(mynmds, display=\"sites\", col=group, pch=16)\ntext(mynmds$points, labels=rownames(sp.abd), cex=0.7, pos = 1)\nlegend(\"bottomright\", legend=unique(group), col=unique(group), pch=16, title = \"Group\")\n```\n\n@fig-shownmdsplot menyajikan pola sebaran titik-titik sebagai perwakilan sampel, yang dalam konteks ini adalah transek. Jarak antara titik-titik ini menggambarkan tingkat kemiripan atau perbedaan dalam komposisi spesies antara komunitas. Jarak yang lebih dekat antara titik-titik menunjukkan komposisi spesies yang lebih mirip, sementara jarak yang lebih jauh menunjukkan perbedaan yang lebih besar. Dapat dilihat bahwa TS07 memiliki komposisi yang sangat jauh berbeda dibandingkan transek lainnya.\n\n## Pengaruh Faktor Lingkungan terhadap Kelimpahan Spesies: Model Linier Umum (GLM)\n\nBagian ini akan membahas penggunaan Model Linier Umum (GLM) dalam menganalisis pengaruh faktor lingkungan terhadap kelimpahan spesies. Model ini memungkinkan kita untuk mempelajari hubungan antara variabel dependen (misalnya, kelimpahan spesies) dan satu atau lebih variabel independen (faktor lingkungan). GLM fleksibel dalam mengakomodasi berbagai distribusi variabel respon, seperti distribusi poisson (kelimpahan) atau binomial (keberadaan/ketiadaan), yang umum ditemukan dalam data ekologi.\n\n#### GLM dengan variabel kontinu\n\nSkrip di bawah ini menunjukkan contoh analisis hubungan antara variabel kontinu, di mana kita akan mengevaluasi pengaruh elevasi, keragaman jenis pohon, kepadatan pohon, dan jumlah pohon pakan terhadap kelimpahan merpati hijau Sumatra (*Treron oxyurus).*\n\n```{r glm_basic, echo=T, results='hide'}\n\n#Menghitung kelimpahan spesies disetiap transek\nspecies_abundance <- raw %>%\n  filter(Scientific.Name == \"Treron oxyurus\") %>% #ganti nama spesies ini untuk jenis lainnya\n  group_by(Transect) %>%\n  summarise(Abundance = n())\n\n#menggabungkan data kelimpahan dan variabel lingkungan\nraw_env_bird <- left_join(raw_env, species_abundance, by = \"Transect\") %>%\n  replace_na(list(Abundance = 0))\n\nglm1 <- glm(Abundance ~ Elev +  Tree.count + Tree.rich +  Imp.Tree, data = raw_env_bird, family = \"poisson\") #GLM menggunakan poisson\nglm2 <- glm(Abundance ~ Elev +  Tree.count + Tree.rich +  Imp.Tree, data = raw_env_bird, family = \"quasipoisson\") #GLM dengan quasipoison\n\n#periksa ringkasan hasil kedua model tersebut\nsummary(glm1)\nsummary(glm2)\n```\n\n```{r glm1, echo=FALSE, message=FALSE, warning=FALSE}\nsummary(glm1)\n```\n\nBerdasarkan ringkasan kedua model di atas, nilai dispersinya mendekati 1, sehingga kita akan menggunakan GLM dengan distribusi Poisson. Hasil tersebut menunjukkan bahwa variabel yang signifikan (P \\< 0.05) adalah keragaman jenis pohon dengan nilai positif, yang mengindikasikan bahwa semakin beragam vegetasi di suatu area, kelimpahan burung tersebut cenderung lebih tinggi.\n\nSelanjutnya, skrip dibawah ini bisa digunakan untuk membuat plot yang menggambarkan pengaruh keragaman jenis pohon terhadap kelimpahan burung.\n\n```{r glmcplot, results='hide', fig.show='hide'}\n# Membuat tabel prediksi dari model terbaik\npred_df <- data.frame(Tree.rich = seq(min(raw_env_bird$Tree.rich), max(raw_env_bird$Tree.rich), length.out = 1000), \n                      Elev = mean(raw_env_bird$Elev),\n                      Tree.count = mean(raw_env_bird$Tree.count),\n                      Imp.Tree =mean(raw_env_bird$Imp.Tree))\n\npred_df$Abundance <- predict(glm1, newdata = pred_df, type = \"response\")\n\n# Membuat plot prediksi kelimpahan burung dari keragaman jenis pohon\nggplot(raw_env_bird, aes(x = Tree.rich, y = Abundance)) +\n  geom_point(alpha = 0.5, color = \"#3B6B9A\") + \n  geom_smooth(method = \"glm\", method.args = list(family = \"poisson\"), se = TRUE, color = \"#8C510A\") +\n  theme_bw(base_size = 16) +\n  ggtitle(\"Predicted abundance by tree richness\") +\n  xlab(\"Tree richness\") +\n  ylab(\"Predicted abundance\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 20),\n        axis.title.x = element_text(size = 20),\n        axis.title.y = element_text(size = 20),\n        axis.text.x = element_text(size = 16),\n        axis.text.y = element_text(size = 16),\n        legend.title = element_blank(),\n        legend.text = element_text(size = 16),\n        legend.position = \"bottom\")\n```\n\n```{r showglmcpl, echo=FALSE, fig.align='center', fig.height=6, fig.width=8, message=FALSE, warning=FALSE}\n#| label: fig-showglmcpl\n#| fig-cap: \"Grafik pengaruh keanekaragaman pohon terhadap kelimpahan burung merpati hijau\"\n\nggplot(raw_env_bird, aes(x = Tree.rich, y = Abundance)) +\n  geom_point(alpha = 0.5, color = \"#3B6B9A\") + \n  geom_smooth(method = \"glm\", method.args = list(family = \"poisson\"), se = TRUE, color = \"#8C510A\") +\n  theme_bw(base_size = 16) +\n  ggtitle(\"Predicted abundance by tree richness\") +\n  xlab(\"Tree richness\") +\n  ylab(\"Predicted abundance\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 20),\n        axis.title.x = element_text(size = 20),\n        axis.title.y = element_text(size = 20),\n        axis.text.x = element_text(size = 16),\n        axis.text.y = element_text(size = 16),\n        legend.title = element_blank(),\n        legend.text = element_text(size = 16),\n        legend.position = \"bottom\")\n```\n\n#### GLM dengan variable kategori\n\nBagian ini akan membahas penggunaan Model Linier Umum (GLM) dalam menganalisis pengaruh faktor lingkungan tipe kategori terhadap kelimpahan spesies. Dalam contoh ini, kita akan mengevaluasi pengaruh tutupan lahan, yang mencakup hutan primer, hutan sekunder, hutan tanaman, dan tanah terbuka, terhadap kelimpahan merpati hijau Sumatra (*Treron oxyurus*). Skrip di bawah ini menunjukkan cara menggunakan GLM untuk memodelkan hubungan antara kelimpahan burung dengan variabel kategori tutupan lahan.\n\n```{r glmcat, echo=T, results='hide'}\n### GLM untuk variabel kategori\nglm3 <- glm(Abundance ~ Tuplah, data = raw_env_bird, family = \"poisson\")\nglm4 <- glm(Abundance ~ Tuplah, data = raw_env_bird, family = \"quasipoisson\")\n\nsummary(glm3)\nsummary(glm4)\n```\n\n```{r glm3, echo=FALSE, message=FALSE, warning=FALSE}\nsummary(glm3)\n```\n\nHasil analisis GLM terbaik menggunakan model Poisson pada model glm3, karena nilai dispersinya mendekati 1. hasil tersebut menunjukan bahwa kelimpahan merpati hijau Sumatra (*Treron oxyurus*) secara signifikan lebih tinggi di hutan primer dibandingkan dengan hutan sekunder dan hutan tanaman. Perbedaan kelimpahan burung di hutan sekunder dan hutan tanaman lebih rendah daripada di hutan primer, dengan nilai yang signifikan (P\\<0.05) untuk kedua kategori tersebut. Sementara itu, tidak ada bukti yang cukup untuk menyatakan perbedaan signifikan antara kelimpahan burung di tanah terbuka dengan hutan primer.\n\nSelanjutnya anda dapat menggunakan skrip dibawah ini untuk membuat plot dari model tersebut\n\n```{r glmcatplot, results='hide', fig.show='hide'}\n# Membuat tabel prediksi dari model terbaik\npred_df <- data.frame(Tuplah = unique(raw_env_bird$Tuplah))\npred_df$Predicted <- predict(glm3, newdata = pred_df, type = \"response\", se.fit = TRUE)$fit\npred_df$SE <- predict(glm3, newdata = pred_df, type = \"response\", se.fit = TRUE)$se.fit\n\n# Membuat plot prediksi kelimpahan burung dari perbedaan tutupan lahan\nggplot(data = pred_df, aes(x = Tuplah, y = Predicted, fill = Tuplah)) +\n  geom_bar(stat = \"identity\", position = position_dodge(), color = \"black\") +\n  geom_errorbar(aes(ymin = Predicted - SE, ymax = Predicted + SE), \n                position = position_dodge(width = 0.9), width = 0.2) +\n  scale_fill_manual(values = c(\"#74C476\", \"#6BAED6\", \"#FD8D3C\", \"#9E9AC8\")) +\n  labs(x = \"Landcover\", y = \"Predicted abundance\",\n       title = \"Predicted abundance by landcover\",\n       fill = \"\") +\n  theme_bw() +\n  theme(plot.title = element_text(size = 14, face = \"bold\", hjust = 0.5),\n        axis.title = element_text(size = 12, face = \"bold\"),\n        axis.text = element_text(size = 10),\n        legend.title = element_blank(),\n        legend.text = element_text(size = 10),\n        legend.position = \"bottom\",\n        panel.grid = element_blank(),\n        panel.background = element_blank(),\n        panel.border = element_rect(colour = \"black\", fill = NA, size = 0.5))\n```\n\n```{r showglmcatpl, echo=FALSE, fig.align='center', fig.height=6, fig.width=8, message=FALSE, warning=FALSE}\n#| label: fig-showglmcatpl\n#| fig-cap: \"Grafik pengaruh tutupan lahan terhadap kelimpahan burung\"\n\nggplot(raw_env_bird, aes(x = Tree.rich, y = Abundance)) +\n  geom_point(alpha = 0.5, color = \"#3B6B9A\") + \n  geom_smooth(method = \"glm\", method.args = list(family = \"poisson\"), se = TRUE, color = \"#8C510A\") +\n  theme_bw(base_size = 16) +\n  ggtitle(\"Predicted abundance by tree richness\") +\n  xlab(\"Tree richness\") +\n  ylab(\"Predicted abundance\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 20),\n        axis.title.x = element_text(size = 20),\n        axis.title.y = element_text(size = 20),\n        axis.text.x = element_text(size = 16),\n        axis.text.y = element_text(size = 16),\n        legend.title = element_blank(),\n        legend.text = element_text(size = 16),\n        legend.position = \"bottom\")\n```\n\n## Pengaruh Faktor Lingkungan terhadap komposisi Spesies: Canonical Correspondence Analysis (CCA)\n\nBagian ini akan membahas analisis menggunakan *Canonical Correspondence Analysis* (CCA). CCA merupakan metode multivariat yang digunakan untuk menganalisis hubungan antara variabel lingkungan dengan pola komposisi spesies dalam suatu komunitas. Melalui analisis CCA, kita dapat mengidentifikasi faktor lingkungan yang paling berpengaruh terhadap komposisi spesies, serta membuat visualisasi hubungan antara spesies, kondisi lingkungan, dan lokasi transek dalam bentuk grafik dua dimensi.\n\nSkrip dibawah ini dapat digunakan untuk melalukan analisa CCA secara sederhana mengenai komposisi komunitas burung di setiap transek terhadap perbedaan elevasi, keanekaragaman pohon, kelimpahan pohon penting dan tutupan lahan.\n\n```{r ccabase,  results='hide', fig.show='hide'}\n# Membuat matriks kelimpahan spesies\nsp.abd <- raw %>%\n  count(Transect, Scientific.Name) %>%\n  pivot_wider(names_from = Scientific.Name, values_from = n, values_fill = list(n = 0)) %>%\n  column_to_rownames(var = \"Transect\")\n\n# Membuat matriks variabel lingkungan\nsp.env <- raw_env %>%\n  column_to_rownames(var = \"Transect\") %>%\n  select (c(3:7)) %>%\n  mutate(Elev = scale(Elev)) %>% #opsional, jika ingin menstandarisasi data\n  mutate(Tree.count = scale(Tree.count)) %>%\n  mutate(Imp.Tree = scale(Imp.Tree)) %>%\n  mutate(Tree.rich = scale(Tree.rich)) %>%\n  mutate(Tuplah = as.factor(Tuplah))\n\n# Menghitung CCA dengan variabel lingkungan\nOM1 <- cca(sp.abd ~ Elev + Tuplah + Tree.count + Tree.rich, sp.env)\n\n# Membuat plot sederhana\nplot1 <- plot(OM1, display=c(\"bp\", \"sp\", \"sites\"))\n```\n\n```{r ccabasepl, echo=FALSE, fig.align='center', fig.height=6, fig.width=8, message=FALSE, warning=FALSE}\n#| label: fig-ccabasepl\n#| fig-cap: \"Grafik ordinasi CCA sederhana\"\n\nplot1 <- plot(OM1, display=c(\"bp\", \"sp\", \"sites\"))\n\n```\n\nPlot yang ditampilkan pada @fig-ccabasepl diatas dapat dimodifikasi agar lebih mudah dibaca dengan menggunakan fungsi dari ggplot pada skrip dibawah ini.\n\n```{r ccaplot, results='hide', fig.show='hide'}\n# Konversi hasil perhitungan CCA kedalam data frame\ndf <- fortify(OM1)\n\n# memilih 10 spesies yang paling dominan\ndom_sp <- raw %>%\n  group_by(Scientific.Name) %>%\n  summarise(abundance = n()) %>%\n  arrange(desc(abundance)) %>%\n  slice(1:10)\n\n# Membuat plot baru dengan ggplot\nggplot() + \n  geom_vline(xintercept = c(0), color = \"grey70\", linetype = 2) +\n  geom_hline(yintercept = c(0), color = \"grey70\", linetype = 2) +  \n  scale_x_continuous(sec.axis = dup_axis(labels=NULL, name=NULL), name = \"CCA1\") +\n  scale_y_continuous(sec.axis = dup_axis(labels=NULL, name=NULL), name = \"CCA2\") +    \n  geom_point(aes(x=CCA1, y=CCA2), data=filter(df, Score==\"sites\"), size = 3, color = \"#1f77b4\") + \n  geom_segment(aes(x = 0, y = 0, xend = CCA1*2.5, yend = CCA2*2.5), data = filter(df, Score==\"biplot\"),color = \"#d62728\", arrow=arrow(length = unit(0.3, \"cm\"))) +\n  geom_text_repel(aes(x=CCA1*2.5, y=CCA2*2.5, label=Label),data = filter(df, Score==\"biplot\"),color = \"#d62728\", size = 4) + \n  geom_text_repel(aes(x=CCA1, y=CCA2, label=Label), \n                  data=filter(df, Score==\"species\", Label %in% dom_sp$Scientific.Name),\n                  color = \"#2ca02c\", size = 4) +\n  geom_text_repel(aes(x=CCA1, y=CCA2, label=Label), data=filter(df, Score==\"sites\"),color = \"#1f77b4\", size = 4) +\n  theme_bw() +\n  theme(axis.text = element_text(size = 12),\n        axis.title = element_text(size = 14),\n        legend.position = \"none\")\n```\n\n```{r showccaplot, echo=FALSE, fig.align='center', fig.height=6, fig.width=8, message=FALSE, warning=FALSE}\n#| label: fig-showccaplot\n#| fig-cap: \"Grafik ordinasi CCA komunitas burung terhadap variabel lingkungan\"\n\nggplot() + \n  geom_vline(xintercept = c(0), color = \"grey70\", linetype = 2) +\n  geom_hline(yintercept = c(0), color = \"grey70\", linetype = 2) +  \n  scale_x_continuous(sec.axis = dup_axis(labels=NULL, name=NULL), name = \"CCA1\") +\n  scale_y_continuous(sec.axis = dup_axis(labels=NULL, name=NULL), name = \"CCA2\") +    \n  geom_point(aes(x=CCA1, y=CCA2), data=filter(df, Score==\"sites\"), size = 3, color = \"#1f77b4\") + \n  geom_segment(aes(x = 0, y = 0, xend = CCA1*2.5, yend = CCA2*2.5), data = filter(df, Score==\"biplot\"),color = \"#d62728\", arrow=arrow(length = unit(0.3, \"cm\"))) +\n  geom_text_repel(aes(x=CCA1*2.5, y=CCA2*2.5, label=Label),data = filter(df, Score==\"biplot\"),color = \"#d62728\", size = 4) + \n  geom_text_repel(aes(x=CCA1, y=CCA2, label=Label), \n                  data=filter(df, Score==\"species\", Label %in% dom_sp$Scientific.Name),\n                  color = \"#2ca02c\", size = 4) +\n  geom_text_repel(aes(x=CCA1, y=CCA2, label=Label), data=filter(df, Score==\"sites\"),color = \"#1f77b4\", size = 4) +\n  theme_bw() +\n  theme(axis.text = element_text(size = 12),\n        axis.title = element_text(size = 14),\n        legend.position = \"none\")\n\n```\n\n@fig-showccaplot menunjukkan plot CCA yang telah dimodifikasi dengan memperlihatkan 10 spesies paling melimpah untuk kemudahan interpretasi. Untuk memahami hasil CCA, Anda harus melihat sejauh mana titik-titik transek, spesies, dan panah variabel lingkungan berdekatan. Transek dan spesies yang berada dekat dengan panah variabel lingkungan menandakan bahwa mereka dipengaruhi oleh variabel lingkungan tersebut. Jika panah variabel lingkungan berdekatan atau berpotongan, ini menunjukkan adanya korelasi antara variabel-variabel tersebut dalam menjelaskan pola distribusi spesies.\n\nPada @fig-showccaplot tersebut menunjukkan bahwa panah elevasi dan keragaman jenis pohon berdekatan, yang berarti semakin tinggi elevasi, keragaman jenis pohon semakin meningkat. Selain itu, posisi ayam hutan (*Gallus varius*) terletak jauh dari arah elevasi, yang berarti dalam sampel kita, ayam hutan lebih sering ditemukan di daerah dengan elevasi yang lebih rendah dan ditemukan lebih sering di hutan sekunder. Jarak antar titik juga menunjukkan kesamaan komposisi jenis dan variabel lingkungan, seperti transek 5 dan 6 yang lebih mirip satu sama lain dibandingkan dengan transek 3 dan 4 yang memiliki posisi yang lebih jauh. \n\nJika kita bandingkan dengan hasil klaster dan NMDS pada @fig-showclustplot dan @fig-shownmdsplot, posisi relatif titik atau transek ini menjadi berbeda karena metode sebelumnya hanya mempertimbangkan komposisi spesies, sedangkan CCA mencakup variabel-variabel lingkungan sehingga menggambarkan kondisi komunitas dan lingkungan yang lebih lengkap.\n\n\n## Analisis Kepadatan Spesies\ntba\n\n## Daftar Spesies Prioritas\ntba"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":true,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["custom.css"],"toc":true,"output-file":"10-lampiran3.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","bibliography":["book.bib"],"editor":"visual","theme":{"light":"cosmo"},"backgroundcolor":"#F5F5F5","fontsize":"1.1em","linestretch":1.7,"crossref":{"fig-title":"Gambar","fig-prefix":"Gambar","tbl-title":"Tabel","tbl-prefix":"Tabel","sec-prefix":"Bab","sec-labels":"alpha"}},"extensions":{"book":{"multiFile":true}}},"docx":{"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":true,"output-divs":true,"output-ext":"docx","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"page-width":6.5},"pandoc":{"default-image-extension":"png","to":"docx","reference-doc":"FFI_Word Template.docx","output-file":"10-lampiran3.docx"},"language":{},"metadata":{"bibliography":["book.bib"],"editor":"visual"},"extensions":{"book":{}}}}}